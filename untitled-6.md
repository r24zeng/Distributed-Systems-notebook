# 8.传输协议

> 请求者和回应者之间的信息传输机制

协议：定义了信息传输的格式、顺序，消息发送和接收的行为机制

## 层级协议

传进来一个请求，每一层都完成一个功能然后传给下一层，那么就需要层级协议进行层与层之间的通信。

例如 OSI reference 模型（Open Systems Interconnection Reference Model）。主要分成三部分：函数层（中间层），每层间的协议，接口。

信息的固定格式（七层）：每层都串联起整个功能都运作，都有各自的层级协议串联上下两层

* 物理层
* 数据连接层（物理层和数据连接层例子：X.25 Ethernet，Packet，Radio ATM，FDDI …）
* 网络层（例：IP）
* 传输层（例：TCP传输控制协议、UDP数据包协议）
* 会话层
* 展示层
* 应用层（例：Socket、FTP、Telnet、NFS、SMTP、HTTP …）

传输的信息打包起来，前缀加上依次这些层级协议，最后加上要传输的信息，末尾需要一个后缀表示信息结束。这样每层通过层级协议，知道自己要做什么。前缀包括些什么呢？包的长度，同步日志，包，协议（email, web, http），目标地址，信息来源的后缀，CRC校验（0 1 码告诉传递的是什么种类的信息）

### 网络协议

TCP：在传输文件前，前端先请求与后端相连，告诉它会发送几个文件过去，后端接收文件的时候如果发现有文件丢失了，会继续请求前端发送一次那个文件，直到接收到所有的文件，例如邮件系统。**TCP非常在乎数据的丢失。**

UDP：不是非常可信赖的，因为只管把文件扔给相应的后端，不管是否存在文件丢失，也不会给前端任何反馈。因此这种协议传输更快更便宜，可以应用于局域网和不在乎数据丢失的系统，但是会随着物理距离变长效果越来越差。

TCP和UDP主要的区别：与距离有关，数据丢失，响应时间。

### IP

直到信息是干嘛的，高效，并且灵活（有很多种方式操作）

## 如果通过网路传输数据

> 通过路由器传输数据
>
> * 硬件电路切换：例如以前的的电话拨号上网。把资源（带宽）分成几部分频段，各部分资源不共享，预留端口给特定的连接，必须要提前申请使用，一旦端口被占用，更多的请求都没有，必须等待直到这个端口可用。硬件保证了传输质量。
> * 软件包切换：无需提前设置，也不需要预留，任何一次连接都占用全部的带宽，但是一旦你使用了这个端口，即使使用部分带宽，也不能被其他人使用。所有的包都在队列里等待使用资源。
> * 两者对比：软件包切换可以使多个用户共享资源（全宽带），不需要提前设置连接，在活跃用户不多的情况下能让更多用户使用，但也容易引起网络拥塞。有问询、放下消息的延迟，以及路由器间数据传输的延迟；硬件电路有线路传播延迟。

