# 6.中间层

> 除了物理层和接口层之外的，叫做中间层

问题：设计好的中间层适用于大部分的应用，但是不同的应用在交互过程中需要的组件可能不同，接口不兼容问题急需解决

解决：打包并且适配到不同的用户端的应用

问题：需要很多包装

进化：提高适配中间层，中间层打包功能使其适用于多数用户应用

## 适配器

* 例1: 对象适配器是一个允许调用远程某个对象的部件，尽管那些对象可能是一个操作关系数据库的函数的集合。
* 例2: Amazon S3 存储服务。客户端想使用 RESTfull 框架，那么客户可以通过HTTP协议和传统的网站服务器沟通，这是传统的网站服务器就是适配器对接实际的存储服务，处理部分的请求剖析比ing传入到S3内部的存储器。

## 打包

> 用已存在的部件拓展系统的功能，有利于规模化
>
> * 方法一：如果应用B想要应用A的数据，可以将数据特别打包给B，这意味着如果有N个应用想要自由获取任意应用的数据，则需要N\(N-1\)个包，浪费资源
> * 方法二：调解员，管理所有应用数据的入口，信息调解员是最常见的方式。调解员需要跟每个应用沟通，沟通靠包，如果一共N个应用，则一共最多需要2N个包，N个包从应用到调解员，N个包从调解员到用户。

## 拦截器

> 对象A发送请求到对象B，可能有多个一样到B存在，用拦截器可以分别调用发送请求给每个对象B，多个对象B回应同一个对象A时，拦截器拦截了回应，整理成一个回应发送给A。这样A和B都同时感受不到多个重复任务到处理，只有终极爱你层到拦截器知道。拦截器的作用是拦截正常的工作流，从而达到对接特定的应用的效果。

用户端发送请求（第一层，对象A） -&gt; 中间层处理调用程序处理请求（第二层）-&gt; 本地操作系统（第三层）-&gt; 到达对象B。 第一、二层中间有请求层拦截器，即便是有多个重复的B，拦截器都一一调用函数；第二、三层中间有信息层拦截器，将很大的参数分解成小部分一一传输，到达目标对象后再集成传给B。这样A和B都感受不到对方的存在。

